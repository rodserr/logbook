[
  {
    "path": "posts/2021-05-26-liverpool-20-21/",
    "title": "Liverpool 20-21",
    "description": "Analysis of 20/21 season of Liverpool FC",
    "author": [
      {
        "name": "Rodrigo Serrano",
        "url": "https://example.com/norajones"
      }
    ],
    "date": "2021-05-26",
    "categories": [
      "soccer",
      "descriptives"
    ],
    "contents": "\n\n\nhide\n\nlibrary(tidyverse)\nlibrary(understatr)\nlibrary(ggsoccer)\n\n\n\nSeasons\n\n\nhide\n\nepl <- list(2020, 2019, 2018) %>%\n  map_df(~get_league_teams_stats('EPL', year = .x))\n\n\n\n\n\nhide\n\nlfc_matches <- epl %>% filter(team_name == 'Liverpool') \n\nlfc_matches %>% \n  arrange(date) %>%\n  group_by(year = as_factor(year)) %>% \n  transmute(\n    cm_pts = cumsum(pts),\n    match = 1:n()\n  ) %>% \n  ggplot(\n    aes(x = match, y = cm_pts, color = year, alpha = (year != 2020))\n  ) +\n  geom_line() +\n  scale_alpha_manual(values = c(1, .3), guide = FALSE)\n\n\n\nhide\n\nlfc_matches %>% \n  mutate(miss_matches = (xG > xGA) & result != 'w') %>% \n  group_by(year) %>% \n  summarise(mm = sum(miss_matches))\n\n\n# A tibble: 3 x 2\n   year    mm\n  <dbl> <int>\n1  2018     3\n2  2019     4\n3  2020     8\n\nPlayer Seasons\n\n\nhide\n\nlfc_players <- list(2020, 2019, 2018) %>% \n  map_df(~get_team_players_stats('Liverpool', year = .x))\n\n\n\n\n\nhide\n\n# Attackers\nmain_FW <- lfc_players %>% \n  filter(player_id %in% c(1250, 838, 482))\n\nmain_FW %>% \n  transmute(\n    player_name, year,\n    GA_90m = ((npg+assists)/time)*90,\n    xGA_90m = ((npxG+xA)/time)*90\n  ) %>%\n  pivot_longer(c(GA_90m, xGA_90m)) %>% \n  ggplot(aes(x = year, y = value, color = name)) +\n  geom_line() +\n  geom_point() +\n  scale_x_continuous(breaks = c(2018, 2019, 2020)) +\n  facet_wrap(~player_name) +\n  theme(\n    legend.position = 'top',\n    legend.justification = 'left'\n  )\n\n\n\nhide\n\nmain_FW %>% \n  group_by(year) %>% \n  summarise(\n    possible_minutes_played = sum(time)/(94*38*3)\n  )\n\n\n# A tibble: 3 x 2\n   year possible_minutes_played\n  <dbl>                   <dbl>\n1  2018                   0.840\n2  2019                   0.812\n3  2020                   0.819\n\nhide\n\n# Main contributor\nlfc_players %>% \n  mutate(\n    GA_90m = ((npg+assists)/time)*90,\n    n = tidytext::reorder_within(player_name, GA_90m, year)\n  ) %>% \n  group_by(year) %>% \n  slice_max(order_by = GA_90m, n = 5) %>% \n  ggplot(aes(x = GA_90m, y = n)) +\n  geom_col() +\n  facet_wrap(~year, scales = 'free_y') +\n  tidytext::scale_y_reordered() \n\n\n\n\nFabinho\n\n\nhide\n\nfabinho <- get_player_matches_stats(player_id = 3420)\n\n\n\n\n\nhide\n\nfabinho %>% \n  filter(year == 2020, position == 'DC') %>% \n  slice_min(date) %>% \n  pull(date)\n\n\n[1] \"2020-09-20\"\n\nhide\n\nfabinho %>% \n  filter(year == 2020) %>% \n  mutate(\n    pts = case_when(\n      h_team == 'Liverpool' & h_goals > a_goals ~ 3, \n      a_team == 'Liverpool' & h_goals < a_goals ~ 3, \n                              h_goals == a_goals ~ 1,\n                                              T ~ 0\n    )\n  ) %>% \n  group_by(position) %>% \n  summarise(\n    pts = sum(pts)/(n()*3),\n    games = n()\n  )\n\n\n# A tibble: 3 x 3\n  position   pts games\n  <chr>    <dbl> <int>\n1 DC       0.490    17\n2 MC       0.848    11\n3 Sub      0.5       2\n\nhide\n\nfabinho %>% \n  filter(year == 2020) %>% \n  distinct(match_id) %>% \n  nrow()\n\n\n[1] 30\n\nNew players\n\n\nhide\n\nnew_players <- list(6854, 229) %>% \n  map_df(~get_player_matches_stats(.x))\n\n\n\n\n\nhide\n\nnew_players %>% \n  filter(year %in% c(2020, 2019, 2018)) %>%\n  mutate(\n    GA = npg+assists,\n    xGA = npxG+xA\n  ) %>% \n  group_by(player_name, year) %>% \n  summarise(\n    possible_time = sum(time)/(n()*90),\n    GA_90m = (sum(GA)/sum(time))*90,\n    xGA_90m = (sum(xGA)/sum(time))*90,\n    kp_90m = (sum(key_passes)/sum(time))*90\n  )\n\n\n# A tibble: 6 x 6\n# Groups:   player_name [2]\n  player_name       year possible_time GA_90m xGA_90m kp_90m\n  <chr>            <dbl>         <dbl>  <dbl>   <dbl>  <dbl>\n1 Diogo Jota        2018         0.809 0.525    0.541  1.01 \n2 Diogo Jota        2019         0.761 0.309    0.567  1.12 \n3 Diogo Jota        2020         0.651 0.727    0.713  0.969\n4 Thiago Alcántara  2018         0.893 0.299    0.227  1.46 \n5 Thiago Alcántara  2019         0.821 0.152    0.187  1.02 \n6 Thiago Alcántara  2020         0.863 0.0483   0.182  1.45 \n\nShots\n\n\nhide\n\nmatch_shots <- rbind(new_players, fabinho) %>%\n  filter(year == 2020) %>%\n  distinct(match_id) %>%\n  pull() %>%\n  map_df(~get_match_shots(.x))\n\n\n\n\n\nhide\n\nlfc_shots <- match_shots %>% \n  filter((h_team == 'Liverpool' & h_a == 'h') | (a_team == 'Liverpool' & h_a == 'a'))\n\n.shooters <- lfc_shots %>% \n  count(player_id) %>% \n  slice_max(order_by = n, n = 6) %>% \n  pull(player_id)\n\nshooters_dataset <- lfc_shots %>% \n  filter(player_id %in% .shooters) %>% \n  group_by(player) %>% \n  nest() %>% \n  mutate(\n    shotplot = map(\n      data,\n      ~.x %>% \n        filter(shotType != 'OtherBodyPart') %>% # Mantain consistency over color groups\n        ggplot(aes(x = X*100, y = 100-Y*100, size = xG, color = shotType, alpha = result == 'Goal')) +\n        annotate_pitch() +\n        theme_pitch() +\n        geom_point() +\n        scale_alpha_manual(values = c(.3, 1), guide = FALSE) +\n        coord_flip(xlim = c(60, 101), ylim = c(0, 100))\n    )\n  ) %>% \n  ungroup()\n\nlfc_shots %>% \n  group_by(situation) %>% \n  summarise(\n    xG = sum(xG),\n    n = n(), \n    goal = sum(result == 'Goal')\n  )\n\n\n# A tibble: 5 x 4\n  situation         xG     n  goal\n  <chr>          <dbl> <int> <int>\n1 DirectFreekick  1.34    22     0\n2 FromCorner      8.12    93    10\n3 OpenPlay       57.5    464    47\n4 Penalty         4.57     6     6\n5 SetPiece        1.85    23     2\n\n\n\nTrent Alexander-Arnold\n\n\n\nMohamed Salah\n\n\n\nSadio Mané\n\n\n\nRoberto Firmino\n\n\n\nGeorginio Wijnaldum\n\n\n\nDiogo Jota\n\n\n\n\n\n\n\nhide\n\nshooters_dataset$shotplot[[1]]\n\n\n\n\nHoodiness\n\n\nhide\n\nposition_table <- epl %>% \n  filter(year == 2020) %>% \n  group_by(team_name) %>% \n  summarise(pts = sum(pts)) %>% \n  arrange(desc(pts)) %>% \n  transmute(team_name, position = 1:n())\n\nmatch_shots %>% \n  distinct(h_team, a_team, h_goals, a_goals) %>% \n  transmute(\n    team_name = if_else(h_team == 'Liverpool', a_team, h_team),\n    pts =  case_when(\n      h_team == 'Liverpool' & h_goals > a_goals ~ 3, \n      a_team == 'Liverpool' & h_goals < a_goals ~ 3, \n      h_goals == a_goals ~ 1,\n      T ~ 0\n    )) %>% \n  left_join(position_table, by = 'team_name') %>% \n  mutate(\n    position_group = case_when(\n      position <= 6 ~ 'top 6',\n      position >= 14 ~ 'bottom 6',\n      T ~ 'middle table'\n    )\n  ) %>% \n  group_by(position_group) %>% \n  summarise(\n    pts = sum(pts),\n    ppts = pts/(3*n())\n  )\n\n\n# A tibble: 3 x 3\n  position_group   pts  ppts\n  <chr>          <dbl> <dbl>\n1 bottom 6          24 0.571\n2 middle table      28 0.667\n3 top 6             17 0.567\n\n\n\n\n",
    "preview": "posts/2021-05-26-liverpool-20-21/liverpool-20-21_files/figure-html5/season_comparison-1.png",
    "last_modified": "2021-05-27T04:17:44+00:00",
    "input_file": {},
    "preview_width": 1152,
    "preview_height": 576
  },
  {
    "path": "posts/welcome/",
    "title": "Welcome to rodserr Logbook",
    "description": "Welcome to our new blog, rodserr Logbook. We hope you enjoy \nreading what we have to say!",
    "author": [
      {
        "name": "Nora Jones",
        "url": "https://example.com/norajones"
      }
    ],
    "date": "2021-05-26",
    "categories": [],
    "contents": "\n\n\n\n",
    "preview": {},
    "last_modified": "2021-05-26T21:50:43+00:00",
    "input_file": {}
  }
]
